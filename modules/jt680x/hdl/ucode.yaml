ops:
  # 2^8  op entries
  # 2^12 ucode entries -> 16 entries/instruction
  # uCode clock @ 4x E pin clock (uCode clock = crystal frequency)
  - { name: ABA,  op: 0x1b, alu: ADD, op0: a, op1: b,               ld: a,    flags: hnzvc, cycles: 2 }
  - { name: ABX,  op: 0x3b, alu: ADD, op0: b, op1: x,               ld: x,    flags: hnzvc, cycles: 3 }

  - { name: ADCA, op: 0x89, alu: ADD, op0: a,  op1: md,  addr: imm, ld: a, carry: cin, flags: hnzvc, cycles: 2 }
  - { name: ADCA, op: 0x99, alu: ADD, op0: a,  op1: md,  addr: dir, ld: a, carry: cin, flags: hnzvc, cycles: 3 }
  - { name: ADCA, op: 0xa9, alu: ADD, op0: a,  op1: md,  addr: idx, ld: a, carry: cin, flags: hnzvc, cycles: 4 }
  - { name: ADCA, op: 0xb9, alu: ADD, op0: a,  op1: md,  addr: ext, ld: a, carry: cin, flags: hnzvc, cycles: 4 }
  - { name: ADCB, op: 0xc9, alu: ADD, op0: b,  op1: md,  addr: imm, ld: b, carry: cin, flags: hnzvc, cycles: 2 }
  - { name: ADCB, op: 0xd9, alu: ADD, op0: b,  op1: md,  addr: dir, ld: b, carry: cin, flags: hnzvc, cycles: 3 }
  - { name: ADCB, op: 0xe9, alu: ADD, op0: b,  op1: md,  addr: idx, ld: b, carry: cin, flags: hnzvc, cycles: 4 }
  - { name: ADCB, op: 0xf9, alu: ADD, op0: b,  op1: md,  addr: ext, ld: b, carry: cin, flags: hnzvc, cycles: 4 }

  - { name: ADDA, op: 0x8b, alu: ADD, op0: a,  op1: md,  addr: imm, ld: a,    flags: hnzvc, cycles: 2 }
  - { name: ADDA, op: 0x9b, alu: ADD, op0: a,  op1: md,  addr: dir, ld: a,    flags: hnzvc, cycles: 3 }
  - { name: ADDA, op: 0xab, alu: ADD, op0: a,  op1: md,  addr: idx, ld: a,    flags: hnzvc, cycles: 4 }
  - { name: ADDA, op: 0xbb, alu: ADD, op0: a,  op1: md,  addr: ext, ld: a,    flags: hnzvc, cycles: 4 }
  - { name: ADDB, op: 0xcb, alu: ADD, op0: b,  op1: md,  addr: imm, ld: b,    flags: hnzvc, cycles: 2 }
  - { name: ADDB, op: 0xdb, alu: ADD, op0: b,  op1: md,  addr: dir, ld: b,    flags: hnzvc, cycles: 3 }
  - { name: ADDB, op: 0xeb, alu: ADD, op0: b,  op1: md,  addr: idx, ld: b,    flags: hnzvc, cycles: 4 }
  - { name: ADDB, op: 0xfb, alu: ADD, op0: b,  op1: md,  addr: ext, ld: b,    flags: hnzvc, cycles: 4 }

  - { name: ADDD, op: 0xc3, alu: ADD, op0: d,  op1: md,  addr: imm16, ld: d,    flags: nzvc, cycles: 4 }
  - { name: ADDD, op: 0xd3, alu: ADD, op0: d,  op1: md,  addr: dir16, ld: d,    flags: nzvc, cycles: 5 }
  - { name: ADDD, op: 0xe3, alu: ADD, op0: d,  op1: md,  addr: idx16, ld: d,    flags: nzvc, cycles: 6 }
  - { name: ADDD, op: 0xf3, alu: ADD, op0: d,  op1: md,  addr: ext16, ld: d,    flags: nzvc, cycles: 6 }

  - { name: ANDA, op: 0x84, alu: AND, op0: a,  op1: md,  addr: imm, ld: a,    flags: nzv0, cycles: 2 }
  - { name: ANDA, op: 0x94, alu: AND, op0: a,  op1: md,  addr: dir, ld: a,    flags: nzv0, cycles: 3 }
  - { name: ANDA, op: 0xa4, alu: AND, op0: a,  op1: md,  addr: idx, ld: a,    flags: nzv0, cycles: 4 }
  - { name: ANDA, op: 0xb4, alu: AND, op0: a,  op1: md,  addr: ext, ld: a,    flags: nzv0, cycles: 4 }
  - { name: ANDB, op: 0xc4, alu: AND, op0: b,  op1: md,  addr: imm, ld: b,    flags: nzv0, cycles: 2 }
  - { name: ANDB, op: 0xd4, alu: AND, op0: b,  op1: md,  addr: dir, ld: b,    flags: nzv0, cycles: 3 }
  - { name: ANDB, op: 0xe4, alu: AND, op0: b,  op1: md,  addr: idx, ld: b,    flags: nzv0, cycles: 4 }
  - { name: ANDB, op: 0xf4, alu: AND, op0: b,  op1: md,  addr: ext, ld: b,    flags: nzv0, cycles: 4 }

  - { name: ASR,  op: 0x67, alu: ASR, op0: md,          addr: idx, wr: true, flags: nzvc, cycles: 6 }
  - { name: ASR,  op: 0x77, alu: ASR, op0: md,          addr: ext, wr: true, flags: nzvc, cycles: 6 }
  - { name: ASRA, op: 0x47, alu: ASR, op0: a, op1: a,  carry: op0m ld: a,    flags: nzvc, cycles: 2 }
  - { name: ASRB, op: 0x57, alu: ASR, op0: b, op1: b,  carry: op0m ld: b,    flags: nzvc, cycles: 2 }
  - { name: ASRD, op: 0x07, alu: ASR, op0: a, op1: b,  carry: op0l ld: d,    flags: nzvc, cycles: 3 }

  - { name: BITA, op: 0x85, alu: AND, op0: a,  op1: md,  addr: imm, flags: nzv0, cycles: 2 }
  - { name: BITA, op: 0x95, alu: AND, op0: a,  op1: md,  addr: dir, flags: nzv0, cycles: 3 }
  - { name: BITA, op: 0xa5, alu: AND, op0: a,  op1: md,  addr: idx, flags: nzv0, cycles: 4 }
  - { name: BITA, op: 0xb5, alu: AND, op0: a,  op1: md,  addr: ext, flags: nzv0, cycles: 4 }
  - { name: BITB, op: 0xc5, alu: AND, op0: b,  op1: md,  addr: imm, flags: nzv0, cycles: 2 }
  - { name: BITB, op: 0xd5, alu: AND, op0: b,  op1: md,  addr: dir, flags: nzv0, cycles: 3 }
  - { name: BITB, op: 0xe5, alu: AND, op0: b,  op1: md,  addr: idx, flags: nzv0, cycles: 4 }
  - { name: BITB, op: 0xf5, alu: AND, op0: b,  op1: md,  addr: ext, flags: nzv0, cycles: 4 }

  # Branches
  - { name: BRA,  op: 0x20, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BRN,  op: 0x21, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BHI,  op: 0x22, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BLS,  op: 0x23, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BCC,  op: 0x24, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BCS,  op: 0x25, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BNE,  op: 0x26, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BEQ,  op: 0x27, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BVC,  op: 0x28, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BVS,  op: 0x29, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BPL,  op: 0x2a, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BMI,  op: 0x2b, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BGE,  op: 0x2c, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BLT,  op: 0x2d, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BGT,  op: 0x2e, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BLE,  op: 0x2f, alu: ADD, op0: md, op1: pc, branch: true,  cycles: 3 }
  - { name: BSR,  op: 0x8d, alu: ADD, op0: md, op1: pc, pshpc:  true,  cycles: 6 }

  - { name: CBA,  op: 0x11, alu: SUB, op0: a, op1: b,           flags: nzvc, cycles: 2 }

  - { name: CLR,  op: 0x6F, op0: zero, addr: idx, wr: true, flags: n0z1v0c0, cycles: 6 }
  - { name: CLR,  op: 0x7F, op0: zero, addr: ext, wr: true, flags: n0z1v0c0, cycles: 6 }
  - { name: CLRA, op: 0x4F, op0: zero,            ld: a,    flags: n0z1v0c0, cycles: 2 }
  - { name: CLRB, op: 0x5F, op0: zero,            ld: b,    flags: n0z1v0c0, cycles: 2 }

  - { name: CMPA, op: 0x81, alu: SUB, op0: a,  op1: md,  addr: imm, flags: nzvc, cycles: 2 }
  - { name: CMPA, op: 0x91, alu: SUB, op0: a,  op1: md,  addr: dir, flags: nzvc, cycles: 3 }
  - { name: CMPA, op: 0xa1, alu: SUB, op0: a,  op1: md,  addr: idx, flags: nzvc, cycles: 4 }
  - { name: CMPA, op: 0xb1, alu: SUB, op0: a,  op1: md,  addr: ext, flags: nzvc, cycles: 4 }
  - { name: CMPB, op: 0xc1, alu: SUB, op0: b,  op1: md,  addr: imm, flags: nzvc, cycles: 2 }
  - { name: CMPB, op: 0xd1, alu: SUB, op0: b,  op1: md,  addr: dir, flags: nzvc, cycles: 3 }
  - { name: CMPB, op: 0xe1, alu: SUB, op0: b,  op1: md,  addr: idx, flags: nzvc, cycles: 4 }
  - { name: CMPB, op: 0xf1, alu: SUB, op0: b,  op1: md,  addr: ext, flags: nzvc, cycles: 4 }

  - { name: COM,  op: 0x63, op0_inv: true, op0: md, addr: idx, wr: true, flags: nzv0c1, cycles: 6 }
  - { name: COM,  op: 0x73, op0_inv: true, op0: md, addr: ext, wr: true, flags: nzv0c1, cycles: 6 }
  - { name: COMA, op: 0x43, op0_inv: true, op0: a,             ld: a,    flags: nzv0c1, cycles: 2 }
  - { name: COMB, op: 0x53, op0_inv: true, op0: b,             ld: b,    flags: nzv0c1, cycles: 2 }

  - { name: DAA,  op: 0x19, alu: DAA, op0: a,                                 flags: nzvc, cycles: 2 }
  - { name: DEC,  op: 0x6A, alu: SUB, op0: md, op1: one, addr: idx, wr: true, flags: nzv , cycles: 6 }
  - { name: DEC,  op: 0x7A, alu: SUB, op0: md, op1: one, addr: ext, wr: true, flags: nzv , cycles: 6 }
  - { name: DECA, op: 0x4A, alu: SUB, op0: a,  op1: one,            ld: a,    flags: nzv , cycles: 2 }
  - { name: DECB, op: 0x5A, alu: SUB, op0: b,  op1: one,            ld: b,    flags: nzv , cycles: 2 }
  - { name: DEX,  op: 0x09, alu: SUB, op0: x,  op1: one,            ld: x,    flags: z,    cycles: 3 }
  - { name: DES,  op: 0x34, alu: SUB, op0: s,  op1: one,            ld: s,                 cycles: 3 }

  - { name: CPX,  op: 0x8c, alu: SUB, op0: x,  op1: md,  addr: imm16,     flags: nzvc, cycles: 4 }
  - { name: CPX,  op: 0x9c, alu: SUB, op0: x,  op1: md,  addr: dir16,     flags: nzvc, cycles: 5 }
  - { name: CPX,  op: 0xac, alu: SUB, op0: x,  op1: md,  addr: idx16,     flags: nzvc, cycles: 6 }
  - { name: CPX,  op: 0xbc, alu: SUB, op0: x,  op1: md,  addr: ext16,     flags: nzvc, cycles: 6 }

  - { name: CLC,  op: 0x0c,                                                flags: c0,  cycles: 2 }
  - { name: CLI,  op: 0x0e,                                                flags: i0,  cycles: 2 }
  - { name: CLV,  op: 0x0a,                                                flags: v0,  cycles: 2 }

  - { name: EORA, op: 0x88, alu: EOR, op0: a,  op1: md,  addr: imm, ld: a,    flags: nzv0, cycles: 2 }
  - { name: EORA, op: 0x98, alu: EOR, op0: a,  op1: md,  addr: dir, ld: a,    flags: nzv0, cycles: 3 }
  - { name: EORA, op: 0xa8, alu: EOR, op0: a,  op1: md,  addr: idx, ld: a,    flags: nzv0, cycles: 4 }
  - { name: EORA, op: 0xb8, alu: EOR, op0: a,  op1: md,  addr: ext, ld: a,    flags: nzv0, cycles: 4 }
  - { name: EORB, op: 0xc8, alu: EOR, op0: b,  op1: md,  addr: imm, ld: b,    flags: nzv0, cycles: 2 }
  - { name: EORB, op: 0xd8, alu: EOR, op0: b,  op1: md,  addr: dir, ld: b,    flags: nzv0, cycles: 3 }
  - { name: EORB, op: 0xe8, alu: EOR, op0: b,  op1: md,  addr: idx, ld: b,    flags: nzv0, cycles: 4 }
  - { name: EORB, op: 0xf8, alu: EOR, op0: b,  op1: md,  addr: ext, ld: b,    flags: nzv0, cycles: 4 }

  - { name: INC,  op: 0x6c, alu: ADD, op0: md, op1: one, addr: idx, wr: true, flags: nzv , cycles: 6 }
  - { name: INC,  op: 0x7c, alu: ADD, op0: md, op1: one, addr: ext, wr: true, flags: nzv , cycles: 6 }
  - { name: INCA, op: 0x4c, alu: ADD, op0: a,  op1: one,            ld: a,    flags: nzv , cycles: 2 }
  - { name: INCB, op: 0x5c, alu: ADD, op0: b,  op1: one,            ld: b,    flags: nzv , cycles: 2 }
  - { name: INX,  op: 0x08, alu: ADD, op0: x,  op1: one,            ld: x,    flags: z,    cycles: 3 }
  - { name: INS,  op: 0x31, alu: ADD, op0: s,  op1: one,            ld: s,                 cycles: 3 }

  - { name: JMP,  op: 0x6e,           op0: md,           addr: idx, ld: pc,               cycles: 3 }
  - { name: JMP,  op: 0x7e,           op0: md,           addr: ext, ld: pc,               cycles: 3 }
  - { name: JSR,  op: 0x9d,           op0: md,           addr: dir, ld: pc, psh_pc: true, cycles: 5 }
  - { name: JSR,  op: 0xad,           op0: md,           addr: idx, ld: pc, psh_pc: true, cycles: 6 }
  - { name: JSR,  op: 0xbd,           op0: md,           addr: ext, ld: pc, psh_pc: true, cycles: 6 }

  - { name: LDAA, op: 0x86,           op0: md,          addr: imm, ld: a,    flags: nzv0, cycles: 2 }
  - { name: LDAA, op: 0x96,           op0: md,          addr: dir, ld: a,    flags: nzv0, cycles: 3 }
  - { name: LDAA, op: 0xa6,           op0: md,          addr: idx, ld: a,    flags: nzv0, cycles: 4 }
  - { name: LDAA, op: 0xb6,           op0: md,          addr: ext, ld: a,    flags: nzv0, cycles: 4 }
  - { name: LDAB, op: 0xc6,           op0: md,          addr: imm, ld: b,    flags: nzv0, cycles: 2 }
  - { name: LDAB, op: 0xd6,           op0: md,          addr: dir, ld: b,    flags: nzv0, cycles: 3 }
  - { name: LDAB, op: 0xe6,           op0: md,          addr: idx, ld: b,    flags: nzv0, cycles: 4 }
  - { name: LDAB, op: 0xf6,           op0: md,          addr: ext, ld: b,    flags: nzv0, cycles: 4 }

  - { name: LDD,  op: 0xcc,           op0: md,          addr: imm16, ld: d,  flags: nzv0, cycles: 3 }
  - { name: LDD,  op: 0xdc,           op0: md,          addr: imm16, ld: d,  flags: nzv0, cycles: 4 }
  - { name: LDD,  op: 0xec,           op0: md,          addr: imm16, ld: d,  flags: nzv0, cycles: 5 }
  - { name: LDD,  op: 0xfc,           op0: md,          addr: imm16, ld: d,  flags: nzv0, cycles: 5 }

  - { name: LDX,  op: 0xcf,           op0: md,          addr: imm16, ld: x,    flags: nzv0, cycles: 3 }
  - { name: LDX,  op: 0xdf,           op0: md,          addr: dir16, ld: x,    flags: nzv0, cycles: 4 }
  - { name: LDX,  op: 0xef,           op0: md,          addr: idx16, ld: x,    flags: nzv0, cycles: 5 }
  - { name: LDX,  op: 0xff,           op0: md,          addr: ext16, ld: x,    flags: nzv0, cycles: 5 }

  - { name: LDS,  op: 0x8e,           op0: md,          addr: imm16, ld: s,    flags: nzv0, cycles: 3 }
  - { name: LDS,  op: 0x9e,           op0: md,          addr: dir16, ld: s,    flags: nzv0, cycles: 4 }
  - { name: LDS,  op: 0xae,           op0: md,          addr: idx16, ld: s,    flags: nzv0, cycles: 5 }
  - { name: LDS,  op: 0xbe,           op0: md,          addr: ext16, ld: s,    flags: nzv0, cycles: 5 }

  # same as ASL
  - { name: LSL,  op: 0x68, alu: LSL, op0: md,          addr: idx, wr: true, flags: nzvc, cycles: 6 }
  - { name: LSL,  op: 0x78, alu: LSL, op0: md,          addr: ext, wr: true, flags: nzvc, cycles: 6 }
  - { name: LSLA, op: 0x48, alu: LSL, op0: a,                      ld: a,    flags: nzvc, cycles: 2 }
  - { name: LSLB, op: 0x58, alu: LSL, op0: b,                      ld: b,    flags: nzvc, cycles: 2 }
  - { name: LSLD, op: 0x05, alu: LSL, op0: a, op1: b,              ld: d,    flags: nzvc, cycles: 3 }

  - { name: LSR,  op: 0x64, alu: LSR, op0: md,          addr: idx, wr: true, flags: n0zvc, cycles: 6 }
  - { name: LSR,  op: 0x74, alu: LSR, op0: md,          addr: ext, wr: true, flags: n0zvc, cycles: 6 }
  - { name: LSRA, op: 0x44, alu: LSR, op0: a,                      ld: a,    flags: n0zvc, cycles: 2 }
  - { name: LSRB, op: 0x54, alu: LSR, op0: b,                      ld: b,    flags: n0zvc, cycles: 2 }
  - { name: LSRD, op: 0x04, alu: LSR, op0: a, op1: b,              ld: d,    flags: n0zvc, cycles: 3 }

  - { name: MUL,  op: 0x3d, alu: MUL, op0: a, op1: b,               ld: d,    flags:    c, cycles: 10}

  - { name: NEG,  op: 0x60, alu: ADD, op0: md, op1: zero, op0_inv: true, addr: idx, carry: hi, wr: true, flags: nzvc, cycles: 2 }
  - { name: NEG,  op: 0x70, alu: ADD, op0: md, op1: zero, op0_inv: true, addr: ext, carry: hi, wr: true, flags: nzvc, cycles: 3 }
  - { name: NEGA, op: 0x40, alu: ADD, op0: a,  op1: zero, op0_inv: true,            carry: hi, ld: a,    flags: nzvc, cycles: 2 }
  - { name: NEGB, op: 0x50, alu: ADD, op0: b,  op1: zero, op0_inv: true,            carry: hi, ld: b,    flags: nzvc, cycles: 2 }

  - { name: NOP,  op: 0x01,                                                              cycles: 1 }

  - { name: ORA,  op: 0x8a, alu: OR,  op0: a,  op1: md,  addr: imm, ld: a,    flags: nzv0, cycles: 2 }
  - { name: ORA,  op: 0x9a, alu: OR,  op0: a,  op1: md,  addr: dir, ld: a,    flags: nzv0, cycles: 3 }
  - { name: ORA,  op: 0xaa, alu: OR,  op0: a,  op1: md,  addr: idx, ld: a,    flags: nzv0, cycles: 4 }
  - { name: ORA,  op: 0xba, alu: OR,  op0: a,  op1: md,  addr: ext, ld: a,    flags: nzv0, cycles: 4 }
  - { name: ORB,  op: 0xca, alu: OR,  op0: b,  op1: md,  addr: imm, ld: b,    flags: nzv0, cycles: 2 }
  - { name: ORB,  op: 0xda, alu: OR,  op0: b,  op1: md,  addr: dir, ld: b,    flags: nzv0, cycles: 3 }
  - { name: ORB,  op: 0xea, alu: OR,  op0: b,  op1: md,  addr: idx, ld: b,    flags: nzv0, cycles: 4 }
  - { name: ORB,  op: 0xfa, alu: OR,  op0: b,  op1: md,  addr: ext, ld: b,    flags: nzv0, cycles: 4 }

  - { name: PSHA, op: 0x36,           op0: a,           addr: psh,                        cycles: 3 }
  - { name: PSHB, op: 0x37,           op0: b,           addr: psh,                        cycles: 3 }
  - { name: PSHX, op: 0x3c,           op0: x,           addr: psh,                        cycles: 4 }
  - { name: PULA, op: 0x32,                             addr: pul,   ld: a,               cycles: 4 }
  - { name: PULB, op: 0x33,                             addr: pul,   ld: b,               cycles: 4 }
  - { name: PULX, op: 0x38,                             addr: pul,   ld: x,               cycles: 5 }

  - { name: ROL,  op: 0x69, alu: ROL, op0: md,          addr: idx, wr: true, flags: nzvc, cycles: 6 }
  - { name: ROL,  op: 0x79, alu: ROL, op0: md,          addr: ext, wr: true, flags: nzvc, cycles: 6 }
  - { name: ROLA, op: 0x49, alu: ROL, op0: a,                      ld: a,    flags: nzvc, cycles: 2 }
  - { name: ROLB, op: 0x59, alu: ROL, op0: b,                      ld: b,    flags: nzvc, cycles: 2 }

  - { name: ROR,  op: 0x66, alu: ROR, op0: md,          addr: idx, wr: true, flags: nzvc, cycles: 6 }
  - { name: ROR,  op: 0x76, alu: ROR, op0: md,          addr: ext, wr: true, flags: nzvc, cycles: 6 }
  - { name: RORA, op: 0x46, alu: ROR, op0: a,                      ld: a,    flags: nzvc, cycles: 2 }
  - { name: RORB, op: 0x56, alu: ROR, op0: b,                      ld: b,    flags: nzvc, cycles: 2 }

  - { name: SBA,  op: 0x10, alu: SUB, op0: a, op1: b,               ld: a,    flags: nzvc, cycles: 2 }

  - { name: SBCA, op: 0x82, alu: SUB, op0: a,  op1: md,  addr: imm, ld: a, carry: cin, flags: nzvc, cycles: 2 }
  - { name: SBCA, op: 0x92, alu: SUB, op0: a,  op1: md,  addr: dir, ld: a, carry: cin, flags: nzvc, cycles: 3 }
  - { name: SBCA, op: 0xa2, alu: SUB, op0: a,  op1: md,  addr: idx, ld: a, carry: cin, flags: nzvc, cycles: 4 }
  - { name: SBCA, op: 0xb2, alu: SUB, op0: a,  op1: md,  addr: ext, ld: a, carry: cin, flags: nzvc, cycles: 4 }
  - { name: SBCB, op: 0xc2, alu: SUB, op0: b,  op1: md,  addr: imm, ld: b, carry: cin, flags: nzvc, cycles: 2 }
  - { name: SBCB, op: 0xd2, alu: SUB, op0: b,  op1: md,  addr: dir, ld: b, carry: cin, flags: nzvc, cycles: 3 }
  - { name: SBCB, op: 0xe2, alu: SUB, op0: b,  op1: md,  addr: idx, ld: b, carry: cin, flags: nzvc, cycles: 4 }
  - { name: SBCB, op: 0xf2, alu: SUB, op0: b,  op1: md,  addr: ext, ld: b, carry: cin, flags: nzvc, cycles: 4 }

  - { name: SEC,  op: 0x0d,                                                flags: c1,     cycles: 2 }
  - { name: SEI,  op: 0x0f,                                                flags: i1,     cycles: 2 }
  - { name: SEV,  op: 0x0b,                                                flags: v1,     cycles: 2 }

  - { name: STA,  op: 0x97,           op0: a,           addr: dir, wr:true   flags: nzv0, cycles: 3 }
  - { name: STA,  op: 0xa7,           op0: a,           addr: idx, wr:true   flags: nzv0, cycles: 4 }
  - { name: STA,  op: 0xb7,           op0: a,           addr: ext, wr:true   flags: nzv0, cycles: 4 }
  - { name: STB,  op: 0xd7,           op0: b,           addr: dir, wr:true   flags: nzv0, cycles: 3 }
  - { name: STB,  op: 0xe7,           op0: b,           addr: idx, wr:true   flags: nzv0, cycles: 4 }
  - { name: STB,  op: 0xf7,           op0: b,           addr: ext, wr:true   flags: nzv0, cycles: 4 }
  - { name: STD,  op: 0xdd,           op0: d,           addr: dir, wr:true   flags: nzv0, cycles: 4 }
  - { name: STD,  op: 0xed,           op0: d,           addr: idx, wr:true   flags: nzv0, cycles: 5 }
  - { name: STD,  op: 0xfd,           op0: d,           addr: ext, wr:true   flags: nzv0, cycles: 5 }

  - { name: STS,  op: 0x9f,           op0: s,           addr: dir, wr:true   flags: nzv0, cycles: 4 }
  - { name: STS,  op: 0xaf,           op0: s,           addr: idx, wr:true   flags: nzv0, cycles: 5 }
  - { name: STS,  op: 0xbf,           op0: s,           addr: ext, wr:true   flags: nzv0, cycles: 5 }
  - { name: STX,  op: 0xdf,           op0: x,           addr: dir, wr:true   flags: nzv0, cycles: 4 }
  - { name: STX,  op: 0xef,           op0: x,           addr: idx, wr:true   flags: nzv0, cycles: 5 }
  - { name: STX,  op: 0xff,           op0: x,           addr: ext, wr:true   flags: nzv0, cycles: 5 }

  - { name: SUBA, op: 0x80, alu: SUB, op0: a,  op1: md,  addr: imm, ld: a,  flags: nzvc,  cycles: 2 }
  - { name: SUBA, op: 0x90, alu: SUB, op0: a,  op1: md,  addr: dir, ld: a,  flags: nzvc,  cycles: 3 }
  - { name: SUBA, op: 0xa0, alu: SUB, op0: a,  op1: md,  addr: idx, ld: a,  flags: nzvc,  cycles: 4 }
  - { name: SUBA, op: 0xb0, alu: SUB, op0: a,  op1: md,  addr: ext, ld: a,  flags: nzvc,  cycles: 4 }
  - { name: SUBB, op: 0xc0, alu: SUB, op0: b,  op1: md,  addr: imm, ld: b,  flags: nzvc,  cycles: 2 }
  - { name: SUBB, op: 0xd0, alu: SUB, op0: b,  op1: md,  addr: dir, ld: b,  flags: nzvc,  cycles: 3 }
  - { name: SUBB, op: 0xe0, alu: SUB, op0: b,  op1: md,  addr: idx, ld: b,  flags: nzvc,  cycles: 4 }
  - { name: SUBB, op: 0xf0, alu: SUB, op0: b,  op1: md,  addr: ext, ld: b,  flags: nzvc,  cycles: 4 }

  - { name: SUBD, op: 0x83, alu: SUB, op0: d,  op1: md,  addr: imm16, ld: d,  flags: nzvc, cycles: 4 }
  - { name: SUBD, op: 0x93, alu: SUB, op0: d,  op1: md,  addr: dir16, ld: d,  flags: nzvc, cycles: 5 }
  - { name: SUBD, op: 0xa3, alu: SUB, op0: d,  op1: md,  addr: idx16, ld: d,  flags: nzvc, cycles: 6 }
  - { name: SUBD, op: 0xb3, alu: SUB, op0: d,  op1: md,  addr: ext16, ld: d,  flags: nzvc, cycles: 6 }

  - { name: SWI,  op: 0x3f,                                                flags: i1,     cycles: 12 }

  - { name: TAB,  op: 0x16,           op0: a,                       ld: b,  flags: nzv0,  cycles: 2 }
  - { name: TAP,  op: 0x06,           op0: a,                       ld: cc,               cycles: 2 }
  - { name: TBA,  op: 0x17,           op0: b,                       ld: a,  flags: nzv0,  cycles: 2 }
  - { name: TPA,  op: 0x07,           op0: cc,                      ld: a,                cycles: 2 }
  - { name: TXS,  op: 0x35, alu: SUB, op0: x,  op1: one,            ld: s,                cycles: 3 }
  - { name: TSX,  op: 0x30, alu: ADD, op0: s,  op1: one,            ld: x,                cycles: 3 }

  - { name: TST,  op: 0x6d, alu: SUB, op0: md, op1: zero, addr: idx,       flags: nzv0c0, cycles: 6 }
  - { name: TST,  op: 0x7d, alu: SUB, op0: md, op1: zero, addr: ext,       flags: nzv0c0, cycles: 6 }
  - { name: TSTA, op: 0x4d, alu: SUB, op0: a,  op1: zero,                  flags: nzv0c0, cycles: 2 }
  - { name: TSTB, op: 0x5d, alu: SUB, op0: b,  op1: zero,                  flags: nzv0c0, cycles: 2 }

  - { name: RTI,  op: 0x3b,                                                flags: nzvc,   cycles: 10 }
  - { name: RTS,  op: 0x39,                               addr: pul, ld: pc,              cycles: 5  }
  - { name: WAI,  op: 0x3e,                                                               cycles: 9  }
ucode:
  - proc: imm # 1+3 ucode cycles = 1 bus cycle
    seq:
      - inc_pc
      - # idle
      - fetch, ret
  - proc: imm16 # 1+7 ucode cycles = 2 bus cycles
    seq:
      - inc_pc
      -
      - fetch
      - inc_pc
      -
      - fetch
      - ret
  - proc: dir # 1+7 ucode cycles = 2 bus cycles
      - inc_pc
      - fetch
      - md_rmux, ld0_opnd
      - alu_nop, ea_ld
      - use_ea
      - use_ea, rd
      - ret
  - proc: ext # 1+11 ucode cycles = 3 bus cycles
      - inc_pc
      - # idle
      - fetch
      - inc_pc
      - # idle
      - fetch
      - md_rmux, ld0_opnd
      - alu_nop, ea_ld
      - use_ea
      - use_ea, fetch
      - ret
  - proc: idx # 1+11 ucode cycles = 3 bus cycles
    seq:
      - inc_pc
      - # idle
      - fetch
      - # idle
      - # idle
      - md_rmux, ld0_opnd
      - x_rmux, ld1_opnd
      - alu_add, ea_ld
      - use_ea
      - use_ea, fetch
      - ret
  - proc: idx16 # 1+11 ucode cycles = 3 bus cycles
    seq:
      - inc_pc
      - md_rmux, ld0_opnd
      - x_rmux, ld1_opnd
      - alu_add, ea_ld
      - use_ea
      - use_ea, fetch # MSB
      - ea_rmux, ld0_opnd
      - one_rmux, ld1_opnd
      - alu_add, ea_ld
      - use_ea, fetch, md_shift # LSB
      - ret
  - proc: psh16 # 2 cycles
    seq:
      - s_rmux, ld0_opnd
      - zero_rmux, ld1_opnd
      - alu_add, ea_ld
      - use_ea, wr
      - one_rmux, ld1_opnd
      - alu_sub, ea_ld, md_shift
      - alu_sub, s_ld, use_ea, wr
      - ret
  - proc: psh # 1 cycle
    seq:
      - s_rmux, ld0_opnd
      - one_rmux, ld1_opnd, alu_nop, ea_ld
      - alu_sub, s_ld, use_ea, wr
      - ret
generics:
  - mnemonics: [
      # Operand from memory (${addr}!=nil)
      ADCA, ADCB, ADDA, ADDB, ADDD,
      ANDA, ANDB,
      BITA, BITB,
      CMPA, CMPB, CPX,
      EORA, EORB,
      LDAA, LDAB, LDD, LDX, LDX,
      ORA,  ORB,
      SBCA, SBCB,
      SUBA, SUBB, SUBD
    ]
    seq:
      - jsr_${addr}
      - ${op0}_rmux, ld0_opnd, inc_pc
      - ${op1}_rmux, ld1_opnd, ${alu}_alu, ${cin}?cin
      - ${ld}_ld, cc_${flags}
      - ni
  # read operand and write result to memory
  - mnemonics: [ ASR, CLR, COM, DEC, INC, LSL, NEG, ROL, TST ]
    seq:
      - jsr_${addr}
      - ${op0}_rmux, ld0_opnd, inc_pc
      - ${op1}_rmux, ld1_opnd, ${alu}_alu, ${cin}?cin
      - md_ld, cc_${flags}
      - wr
      - ni
  - mnemonics: [
      # No addressing (${addr}==nil)
      ASRA, ASRB, ASRD,
      CLRA, CLRB,
      COMA, COMB,
      INCA, INCB, INX, INS,
      LSLA, LSLB, LSLD,
      LSRA, LSRB, LSRD,
      NEGA, NEGB,
      ROLA, ROLB,
      RORA, RORB,
      TAB,  TAP,  TBA, TPA, TXS, TSX
    ]
    seq:
      - # idle 1
      - # idle 2
      - # idle 3
      - # idle 4
      - ${op0}_rmux, ld0_opnd
      - ${op1}_rmux, ld1_opnd, ${alu}_alu, ${cin}?cin
      - ${ld}_ld, cc_${flags}
      - ni
  - mnemonics: [
      BRA, BRN, BHI, BLS,
      BCC, BCS, BNE, BEQ,
      BVC, BVS, BPL, BMI,
      BGE, BLT, BGT, BLE ]
    seq:
      - jsr_imm
      - ${op0}_rmux, ld0_opnd, inc_pc
      - ${op1}_rmux, ld1_opnd, ${alu}_alu
      - branch, pc_ld
      - # idle 2d
      - # idle 3a
      - # idle 3b
      - # idle 3c
      - ni
  - mnemonics: [ BSR ]
    seq:
      - jsr_imm
      - inc_pc
      - ${op0}_rmux, ld0_opnd
      - ${op1}_rmux, ld1_opnd
      - pc_rmux, md_ld
      - jsr_psh16
      - ${alu}_alu, pc_ld
      - # idle 2d
      - # idle 3a
      - # idle 3b
      - # idle 3c
      - ni

